# RSS Reader - 仕様書

モノレポ構成の現代的な RSS リーダーアプリケーション。Web、Native（iOS/Android）対応。

## 機能

- ユーザー登録（✅ 実装済み）
- ログイン（✅ 実装済み）
- パスワードリセット（✅ 実装済み）
- パスワード変更（✅ 実装済み）
- メールアドレス変更（✅ 実装済み）
- カラーテーマ設定（⚠️ API準備済み、UI未実装）
- 言語設定（⚠️ API準備済み、UI未実装）
- フィード登録（✅ 実装済み）
- フィード一覧表示（✅ 実装済み）
- フィードの削除（✅ 実装済み）
- フィードの記事一覧表示（✅ 実装済み）
- 記事の既読/未読管理（✅ 実装済み）
- 記事のブックマーク機能（✅ 実装済み）
- 1日ごとにフィードの自動更新（✅ Vercel Cron Job実装済み）
- OPMLのインポート/エクスポート（✅ Web/API実装済み、Native未実装）
- 記事の検索機能（✅ 実装済み）

## ページ

- トップページ（✅ 実装済み）
- ユーザー登録ページ（✅ 実装済み）
- ログインページ（✅ 実装済み）
- パスワードリセットページ（✅ 実装済み）
- メインダッシュボードページ（✅ 実装済み）
- アカウント・設定ページ（❌ Web未実装、Native実装済み）

## アーキテクチャ

### モノレポ構成
- **apps/api**: Node.js/Express/Prisma API サーバー（✅ 完全実装）
- **apps/web**: Next.js ウェブアプリケーション（✅ メイン機能完全実装）
- **apps/native**: React Native/Expo モバイルアプリ（✅ 高品質実装）
- **packages/sdk**: 各アプリ内で個別実装（✅ 実装済み）

### 技術スタック
- **フロントエンド**: React, TypeScript, Tailwind CSS, React Hook Form, Zod
- **バックエンド**: Node.js, Express, Prisma, PostgreSQL, JWT, bcryptjs, rss-parser
- **モバイル**: React Native, Expo SDK 53, React Navigation 7
- **認証**: JWT ベース認証、レート制限、セキュリティヘッダー
- **ツール**: Turborepo, Biome, Vitest, Supertest
- **デプロイ**: Vercel（API/Web）、EAS Build（Native）

## デザイン/UI

- シンプルでフラットデザイン（✅ 実装済み）
- レスポンシブデザイン（モバイルファースト）（✅ 実装済み）
- ダークモード対応（⚠️ CSS準備済み、UI未実装）
- 多言語対応（日本語/英語）（⚠️ データ準備済み、UI未実装）

## 各ページの構成

### トップページ

- ユーザー登録・ログインページへの誘導
- ユーザー登録・ログインページへのリンク
- 抽象的かつ幾何学的なヒーローセクション
- このアプリケーションの特徴を説明する

### ユーザー登録ページ

- Eメールとパスワードを入力して登録
- Eメールとパスワードのバリデーション
- ユーザー登録の成功・失敗時のメッセージ
- ログイン時には、フィードページへリダイレクト
- すでにアカウントを持っている場合のログインリンク

### ログインページ

- Eメールとパスワードを入力してログイン
- Eメールとパスワードのバリデーション
- ログインの成功・失敗時のメッセージ
- ログイン時には、フィードページへリダイレクト
- ユーザー登録ページへのリンク
- パスワードを忘れた場合のリンク

### パスワードリセットページ

- Eメールを入力してパスワードリセットのリンクを送信
- Eメールのバリデーション
- パスワードリセットの成功・失敗時のメッセージ
- パスワードリセットの成功時には、ユーザー登録・ログインページへリダイレクト

### メインダッシュボードページ（✅ 実装済み）

- 情報量をできるだけ多く取るため最大幅を広く取る
- サイドカラム
  - フィードの登録（✅ 実装済み）
  - 全てフィードをリフレッシュ（✅ 実装済み）
  - 全ての記事（✅ 実装済み）
  - 登録したフィードの一覧（✅ クリックフィルター実装済み）
  - フィードの削除（✅ 実装済み）
  - OPMLインポート/エクスポート（✅ 実装済み）
- メインカラム
  - 記事の閲覧（✅ 実装済み）
  - コンパクトなリスト表示（✅ 実装済み）
  - Favicon/Iconを表示（✅ 実装済み）
  - 記事をクリックしたら、リンクを別タブで開く（✅ 実装済み）
  - 記事検索機能（✅ タイトルと説明文対象で実装済み）
  - 既読/未読管理（✅ 実装済み）
  - ブックマーク機能（✅ 実装済み）
  - ページネーション（✅ 実装済み）

### アカウント・設定ページ

- カラーテーマ設定（システム、ライト、ダーク）（⚠️ API準備済み、Web UI未実装、Native実装済み）
- 言語設定（デフォルト言語は日本語。英語も選択可）（⚠️ API準備済み、UI未実装）
- ユーザー情報の表示（✅ Native実装済み、Web未実装）
- パスワードの変更（✅ API/Native実装済み、Web未実装）
- メールアドレスの変更（✅ API/Native実装済み、Web未実装）
- ログアウト（✅ 全て実装済み）
- アカウントの削除（✅ API/Native実装済み、Web未実装）
- OPMLのインポート（✅ Web実装済み、Native未実装）
- OPMLのエクスポート（✅ Web実装済み、Native未実装）

## 認証・セキュリティ仕様

### 認証方式
- **JWT ベース認証**: ステートレス、スケーラブル
- **トークン有効期限**: 24時間
- **セッション管理**: クライアントサイドでトークン管理

### パスワード仕様
- **最小要件**: 8文字以上、大文字・小文字・数字を含む
- **ハッシュ化**: bcryptjs (saltRounds: 12)
- **リセット機能**: メール経由、1時間有効期限

### セキュリティ対策
- **レート制限**: 
  - 一般API: 15分/100リクエスト
  - ログイン: 15分/10回
  - 登録: 1時間/5回
  - パスワードリセット: 1時間/3回
- **CORS**: 許可ドメインリスト管理
- **セキュリティヘッダー**: XSS防止、CSRF対策
- **入力検証**: Zod スキーマによる厳格な検証
- **エラーハンドリング**: 情報漏洩を防ぐ統一エラーレスポンス

### データ保護
- **個人情報**: メールアドレス、ハッシュ化パスワード
- **ユーザー設定**: テーマ、言語設定
- **データ削除**: アカウント削除時にカスケード削除
- **ログ管理**: 認証イベントのログ記録

## フィード自動更新仕様（✅ 完全実装済み）

### Vercel Cron Job
- **実行頻度**: 1日1回（UTC 0:00）（✅ 実装済み）
- **エンドポイント**: `/api/cron/refresh-feeds`（Next.js API Route）（✅ 実装済み）
- **認証**: CRON_SECRET環境変数による保護（✅ 実装済み）
- **設定**: `vercel.json`で定義（✅ 実装済み）

### 管理API
- **手動実行**: `/api/admin/refresh-all-feeds`（POST）（✅ 実装済み）
- **ログ取得**: `/api/admin/cron-logs`（GET）（✅ 実装済み）
- **認証**: Bearer Token（ADMIN_API_TOKEN）（✅ 実装済み）

### 実行ログ
- **記録内容**: 実行日時、処理フィード数、成功/失敗数、エラー詳細（✅ 実装済み）
- **保存先**: CronLogテーブル（✅ 実装済み）
- **用途**: 監視、デバッグ、パフォーマンス分析（✅ 実装済み）
- **バッチ処理**: 10件ずつ、1秒間隔の安全な処理（✅ 実装済み）
